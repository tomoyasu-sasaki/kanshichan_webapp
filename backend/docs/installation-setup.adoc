= ğŸš€ ç›£è¦–ã¡ã‚ƒã‚“(KanshiChan) ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
:toc: left
:toc-title: ç›®æ¬¡
:toclevels: 4
:numbered:
:source-highlighter: highlight.js
:icons: font
:doctype: book
:version: 1.0.0
:author: KanshiChan Development Team
:email: team@kanshichan.dev
:revnumber: 1.0
:revdate: {docdate}
:experimental:

== ğŸ“– æ¦‚è¦

ç›£è¦–ã¡ã‚ƒã‚“ï¼ˆKanshiChanï¼‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã®åŒ…æ‹¬çš„ãªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã§ã™ã€‚
é–‹ç™ºç’°å¢ƒã‹ã‚‰æœ¬ç•ªç’°å¢ƒã¾ã§ã€æ®µéšçš„ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚

[NOTE]
====
ğŸ“‹ **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæƒ…å ±**

* **å¯¾è±¡èª­è€…**: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€é‹ç”¨ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã€DevOpsã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢
* **å‰æçŸ¥è­˜**: Linuxæ“ä½œã€Docker/Docker Composeã€PythonåŸºç¤
* **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚é–“**: é–‹ç™ºç’°å¢ƒ 30åˆ†ã€æœ¬ç•ªç’°å¢ƒ 2-3æ™‚é–“
* **ã‚µãƒãƒ¼ãƒˆå¯¾è±¡OS**: Ubuntu 20.04+, CentOS 8+, macOS 12+
* **æœ€çµ‚æ›´æ–°**: {docdate}

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: <<configuration-guide>>, <<backend-architecture>>, <<operations-monitoring>>
====

== ğŸ¯ ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

=== ğŸ’» ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢è¦ä»¶

==== æœ€å°è¦ä»¶ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
[cols="2,2,2", options="header"]
|===
|é …ç›® |æœ€å°è¦ä»¶ |æ¨å¥¨è¦ä»¶
|**CPU** |2ã‚³ã‚¢ 2.4GHz |4ã‚³ã‚¢ 3.0GHzä»¥ä¸Š
|**ãƒ¡ãƒ¢ãƒª** |4GB RAM |8GB RAMä»¥ä¸Š
|**ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** |20GB ç©ºãå®¹é‡ |50GB SSD
|**GPU** |ãªã—ï¼ˆCPUæ¨è«–ï¼‰ |NVIDIA GPU (CUDAå¯¾å¿œ)
|===

==== æœ¬ç•ªç’°å¢ƒè¦ä»¶
[cols="2,2,2", options="header"]
|===
|é …ç›® |æœ€å°è¦ä»¶ |æ¨å¥¨è¦ä»¶
|**CPU** |4ã‚³ã‚¢ 3.0GHz |8ã‚³ã‚¢ 3.5GHzä»¥ä¸Š
|**ãƒ¡ãƒ¢ãƒª** |8GB RAM |16GB RAMä»¥ä¸Š
|**ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** |100GB SSD |500GB NVMe SSD
|**GPU** |NVIDIA GPU (6GB VRAM) |NVIDIA RTX 4070ä»¥ä¸Š
|**ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯** |1Gbps |10Gbps
|===

=== ğŸ–¥ï¸ ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¦ä»¶

==== å¿…é ˆã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢
[cols="2,2,3", options="header"]
|===
|ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ |ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |å‚™è€ƒ
|**Python** |3.11.x |3.12.xå¯¾å¿œäºˆå®š
|**Docker** |20.10+ |Containerå®Ÿè¡Œç’°å¢ƒ
|**Docker Compose** |2.0+ |ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
|**Git** |2.30+ |ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ç®¡ç†
|**Redis** |7.0+ |ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
|===

==== AI/MLé–¢é€£ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
[cols="2,2,3", options="header"]
|===
|ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |ç”¨é€”
|**PyTorch** |2.5.1 |æ·±å±¤å­¦ç¿’ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
|**Ultralytics** |8.3.87 |YOLOå®Ÿè£…
|**MediaPipe** |0.10.21 |å§¿å‹¢æ¨å®š
|**OpenCV** |4.11.x |ç”»åƒå‡¦ç†
|**NumPy** |1.24.x |æ•°å€¤è¨ˆç®—
|===

== ğŸ”§ ç’°å¢ƒåˆ¥ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

=== ğŸ’» é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

==== 1. ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/kanshichan/kanshichan.git
cd kanshichan/backend

# ãƒ–ãƒ©ãƒ³ãƒç¢ºèªï¼ˆmainãƒ–ãƒ©ãƒ³ãƒæ¨å¥¨ï¼‰
git branch -a
git checkout main
```

==== 2. Pythonç’°å¢ƒæ§‹ç¯‰
```bash
# Pythonä»®æƒ³ç’°å¢ƒä½œæˆ
python3.11 -m venv venv
source venv/bin/activate  # Linux/macOS
# venv\Scripts\activate  # Windows

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ãƒ„ãƒ¼ãƒ«æ›´æ–°
pip install --upgrade pip setuptools wheel

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt
```

==== 3. Docker Compose ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
```bash
# Docker Compose ã§ Redis èµ·å‹•
docker-compose -f docker-compose.dev.yml up -d redis

# ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ç¢ºèª
docker-compose -f docker-compose.dev.yml ps
```

==== 4. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æº–å‚™
```bash
# ç’°å¢ƒè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
cp config/config.example.yaml config/config.yaml

# é–‹ç™ºç’°å¢ƒç”¨è¨­å®šã‚’é©ç”¨
cp config/env/.env.development .env
```

==== 5. åˆæœŸåŒ–ãƒ»å‹•ä½œç¢ºèª
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ï¼ˆè©²å½“ã™ã‚‹å ´åˆï¼‰
python -m src.scripts.init_db

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
python -m src.app
```

==== é–‹ç™ºç’°å¢ƒæ§‹æˆå›³
[mermaid]
....
graph TB
    subgraph "ğŸ–¥ï¸ é–‹ç™ºãƒã‚·ãƒ³"
        DEV[é–‹ç™ºè€…PC<br/>Ubuntu/macOS/Windows]
        PYTHON[Python 3.11<br/>ä»®æƒ³ç’°å¢ƒ]
        GIT[Git Repository<br/>ãƒ­ãƒ¼ã‚«ãƒ«]
    end
    
    subgraph "ğŸ³ Dockerç’°å¢ƒ"
        REDIS[Redis 7.0<br/>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µãƒ¼ãƒãƒ¼]
        VOLUMES[Docker Volumes<br/>ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–]
    end
    
    subgraph "ğŸ”§ é–‹ç™ºãƒ„ãƒ¼ãƒ«"
        IDE[IDE/ã‚¨ãƒ‡ã‚£ã‚¿<br/>VS Code/PyCharm]
        DEBUG[ãƒ‡ãƒãƒƒã‚¬ãƒ¼<br/>pdb/IPython]
        LINT[ãƒªãƒ³ã‚¿ãƒ¼<br/>black/flake8/mypy]
    end
    
    DEV --> PYTHON
    PYTHON --> GIT
    DEV --> REDIS
    REDIS --> VOLUMES
    DEV --> IDE
    IDE --> DEBUG
    IDE --> LINT
    
    classDef dev fill:#e3f2fd
    classDef docker fill:#f3e5f5
    classDef tools fill:#e8f5e8
    
    class DEV,PYTHON,GIT dev
    class REDIS,VOLUMES docker
    class IDE,DEBUG,LINT tools
....

=== ğŸ­ æœ¬ç•ªç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

==== ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆæ¦‚è¦
[mermaid]
....
graph TB
    subgraph "ğŸŒ Load Balancer"
        LB[Nginx<br/>ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼]
        SSL[SSL Termination<br/>è¨¼æ˜æ›¸ç®¡ç†]
    end
    
    subgraph "ğŸš€ Application Layer"
        APP1[KanshiChan App<br/>Instance 1]
        APP2[KanshiChan App<br/>Instance 2]
        APP3[KanshiChan App<br/>Instance N...]
    end
    
    subgraph "ğŸ’¾ Data Layer"
        REDIS[Redis Cluster<br/>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³]
        FS[File System<br/>ãƒ­ã‚°ãƒ»ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«]
    end
    
    subgraph "ğŸ“Š Monitoring"
        METRICS[Prometheus<br/>ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†]
        LOGS[Fluentd<br/>ãƒ­ã‚°é›†ç´„]
        ALERTS[Grafana<br/>ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ]
    end
    
    subgraph "ğŸ”’ Security"
        FIREWALL[Firewall<br/>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ¶å¾¡]
        AUTH[èªè¨¼ã‚·ã‚¹ãƒ†ãƒ <br/>JWT/OAuth]
    end
    
    LB --> SSL
    SSL --> APP1
    SSL --> APP2
    SSL --> APP3
    
    APP1 --> REDIS
    APP2 --> REDIS
    APP3 --> REDIS
    
    APP1 --> FS
    APP2 --> FS
    APP3 --> FS
    
    APP1 --> METRICS
    APP2 --> METRICS
    APP3 --> METRICS
    
    APP1 --> LOGS
    APP2 --> LOGS
    APP3 --> LOGS
    
    METRICS --> ALERTS
    LOGS --> ALERTS
    
    FIREWALL --> LB
    AUTH --> APP1
    AUTH --> APP2
    AUTH --> APP3
    
    classDef lb fill:#e3f2fd
    classDef app fill:#f3e5f5
    classDef data fill:#e8f5e8
    classDef monitor fill:#fff3e0
    classDef security fill:#fce4ec
    
    class LB,SSL lb
    class APP1,APP2,APP3 app
    class REDIS,FS data
    class METRICS,LOGS,ALERTS monitor
    class FIREWALL,AUTH security
....

==== 1. ã‚·ã‚¹ãƒ†ãƒ ç’°å¢ƒæº–å‚™
```bash
# ã‚·ã‚¹ãƒ†ãƒ æ›´æ–°
sudo apt update && sudo apt upgrade -y

# å¿…é ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt install -y \
    curl wget git vim \
    build-essential \
    python3.11 python3.11-venv python3.11-dev \
    nginx redis-server \
    htop iotop nethogs

# Docker ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# Docker Compose ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
```

==== 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ‡ãƒ—ãƒ­ã‚¤
```bash
# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
sudo mkdir -p /opt/kanshichan
sudo chown $USER:$USER /opt/kanshichan
cd /opt/kanshichan

# ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å–å¾—
git clone https://github.com/kanshichan/kanshichan.git .
git checkout v2.0.0  # å®‰å®šç‰ˆã‚¿ã‚°

# Pythonç’°å¢ƒæ§‹ç¯‰
python3.11 -m venv venv
source venv/bin/activate
pip install --upgrade pip
pip install -r backend/requirements.txt
```

==== 3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```bash
# æœ¬ç•ªç’°å¢ƒè¨­å®šã‚³ãƒ”ãƒ¼
cp backend/config/env/.env.production backend/.env
cp backend/config/config.production.yaml backend/config/config.yaml

# æ©Ÿå¯†æƒ…å ±è¨­å®šï¼ˆç’°å¢ƒå¤‰æ•°ã§ç®¡ç†ï¼‰
export REDIS_PASSWORD="your_secure_redis_password"
export JWT_SECRET_KEY="your_jwt_secret_key"
export API_SECRET_KEY="your_api_secret_key"

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼
python -m backend.src.scripts.validate_config
```

==== 4. Redis ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ§‹ç¯‰
```bash
# Redisè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
sudo tee /etc/redis/redis.conf << EOF
# Redis æœ¬ç•ªç’°å¢ƒè¨­å®š
bind 127.0.0.1
port 6379
requirepass ${REDIS_PASSWORD}
maxmemory 2gb
maxmemory-policy allkeys-lru
save 900 1
save 300 10
save 60 10000
EOF

# Redis ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ãƒ»è‡ªå‹•èµ·å‹•è¨­å®š
sudo systemctl start redis-server
sudo systemctl enable redis-server
sudo systemctl status redis-server
```

==== 5. Nginx ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
```bash
# Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
sudo tee /etc/nginx/sites-available/kanshichan << EOF
server {
    listen 80;
    server_name your-domain.com;
    
    # SSL ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    return 301 https://\$server_name\$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    # SSLè¨­å®š
    ssl_certificate /etc/ssl/certs/kanshichan.crt;
    ssl_certificate_key /etc/ssl/private/kanshichan.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    add_header X-Frame-Options DENY always;
    add_header X-Content-Type-Options nosniff always;
    
    # ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
        
        # WebSocketå¯¾å¿œ
        proxy_http_version 1.1;
        proxy_set_header Upgrade \$http_upgrade;
        proxy_set_header Connection "upgrade";
    }
    
    # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
    location /static/ {
        alias /opt/kanshichan/backend/static/;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
    location /health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
    }
}
EOF

# è¨­å®šæœ‰åŠ¹åŒ–
sudo ln -s /etc/nginx/sites-available/kanshichan /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

==== 6. Systemd ã‚µãƒ¼ãƒ“ã‚¹è¨­å®š
```bash
# systemd ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
sudo tee /etc/systemd/system/kanshichan.service << EOF
[Unit]
Description=KanshiChan Backend Service
After=network.target redis-server.service
Requires=redis-server.service

[Service]
Type=simple
User=kanshichan
Group=kanshichan
WorkingDirectory=/opt/kanshichan/backend
Environment=PATH=/opt/kanshichan/venv/bin
EnvironmentFile=/opt/kanshichan/backend/.env
ExecStart=/opt/kanshichan/venv/bin/python -m src.app
ExecReload=/bin/kill -HUP \$MAINPID
Restart=always
RestartSec=10
StandardOutput=journal
StandardError=journal
SyslogIdentifier=kanshichan

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/kanshichan/backend/logs
ReadWritePaths=/opt/kanshichan/backend/tmp

[Install]
WantedBy=multi-user.target
EOF

# ã‚µãƒ¼ãƒ“ã‚¹æœ‰åŠ¹åŒ–ãƒ»èµ·å‹•
sudo systemctl daemon-reload
sudo systemctl enable kanshichan
sudo systemctl start kanshichan
sudo systemctl status kanshichan
```

=== ğŸ³ Docker ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰

==== Docker Compose æœ¬ç•ªæ§‹æˆ
```yaml
# docker-compose.prod.yml
version: '3.8'

services:
  kanshichan-app:
    build:
      context: .
      dockerfile: Dockerfile.prod
    restart: unless-stopped
    environment:
      - ENVIRONMENT=production
      - REDIS_URL=redis://redis:6379
    volumes:
      - ./logs:/app/logs
      - ./config:/app/config:ro
    depends_on:
      - redis
    networks:
      - kanshichan-network
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '2.0'
          memory: 4G
        reservations:
          cpus: '1.0'
          memory: 2G

  redis:
    image: redis:7-alpine
    restart: unless-stopped
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - redis-data:/data
      - ./config/redis.conf:/usr/local/etc/redis/redis.conf:ro
    networks:
      - kanshichan-network
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 2G

  nginx:
    image: nginx:alpine
    restart: unless-stopped
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./config/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./ssl:/etc/ssl:ro
      - ./logs/nginx:/var/log/nginx
    depends_on:
      - kanshichan-app
    networks:
      - kanshichan-network

volumes:
  redis-data:
    driver: local

networks:
  kanshichan-network:
    driver: bridge
```

==== Docker ãƒ‡ãƒ—ãƒ­ã‚¤ã‚³ãƒãƒ³ãƒ‰
```bash
# ç’°å¢ƒå¤‰æ•°è¨­å®š
export REDIS_PASSWORD="your_secure_password"
export JWT_SECRET="your_jwt_secret"

# ã‚³ãƒ³ãƒ†ãƒŠãƒ“ãƒ«ãƒ‰ãƒ»èµ·å‹•
docker-compose -f docker-compose.prod.yml build
docker-compose -f docker-compose.prod.yml up -d

# ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèª
docker-compose -f docker-compose.prod.yml ps
docker-compose -f docker-compose.prod.yml logs -f kanshichan-app
```

== ğŸ”§ è¨­å®šãƒ»èª¿æ•´

=== âš™ï¸ åŸºæœ¬è¨­å®š

==== config.yaml ä¸»è¦è¨­å®šé …ç›®
```yaml
# åŸºæœ¬è¨­å®š
app:
  name: "KanshiChan"
  version: "2.0.0"
  debug: false
  host: "0.0.0.0"
  port: 8000

# AI/MLè¨­å®š
ai:
  yolo:
    model_path: "yolov8n.pt"
    confidence_threshold: 0.5
    iou_threshold: 0.7
    max_detections: 10
    device: "auto"  # auto/cpu/cuda/mps
    
  mediapipe:
    enabled: true
    model_complexity: 0
    min_detection_confidence: 0.7
    min_tracking_confidence: 0.7
    
  optimization:
    frame_skip_enabled: true
    max_skip_rate: 5
    target_fps: 15.0
    cache_enabled: true
    batch_processing: false

# Redisè¨­å®š
redis:
  host: "localhost"
  port: 6379
  password: "${REDIS_PASSWORD}"
  db: 0
  max_connections: 100
  socket_timeout: 5.0

# ãƒ­ã‚°è¨­å®š
logging:
  level: "INFO"
  format: "json"
  file_path: "logs/kanshichan.log"
  max_file_size: "100MB"
  backup_count: 5
  
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š
security:
  jwt_secret_key: "${JWT_SECRET_KEY}"
  jwt_expiration_hours: 24
  api_rate_limit: 100  # requests per minute
  cors_origins: ["https://your-domain.com"]
```

=== ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

==== GPUè¨­å®šç¢ºèª
```bash
# NVIDIA GPU ç¢ºèª
nvidia-smi

# CUDA ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
python -c "import torch; print(f'CUDA Available: {torch.cuda.is_available()}')"
python -c "import torch; print(f'CUDA Version: {torch.version.cuda}')"

# Apple Silicon MPS ç¢ºèªï¼ˆmacOSï¼‰
python -c "import torch; print(f'MPS Available: {torch.backends.mps.is_available()}')"
```

==== ãƒ¡ãƒ¢ãƒªãƒ»CPUæœ€é©åŒ–
```bash
# ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç¢ºèª
free -h
nproc
cat /proc/cpuinfo | grep "cpu cores"

# Pythonè¨­å®šï¼ˆ.bashrc ã«è¿½åŠ ï¼‰
export OMP_NUM_THREADS=4
export MKL_NUM_THREADS=4
export NUMEXPR_NUM_THREADS=4
```

==== Redis æœ€é©åŒ–è¨­å®š
```bash
# Redis ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–
redis-cli CONFIG SET maxmemory 2gb
redis-cli CONFIG SET maxmemory-policy allkeys-lru

# Redis ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç¢ºèª
redis-cli INFO memory
redis-cli INFO stats
```

== âœ… å‹•ä½œç¢ºèªãƒ»æ¤œè¨¼

=== ğŸ” åŸºæœ¬å‹•ä½œç¢ºèª

==== ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
```bash
# ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒç¢ºèª
curl -X GET http://localhost:8000/health
# Expected: {"status": "healthy", "timestamp": "..."}

# AI/MLæ©Ÿèƒ½ç¢ºèª
curl -X GET http://localhost:8000/api/v1/detection/status
# Expected: {"yolo": "ready", "mediapipe": "ready"}

# Redisæ¥ç¶šç¢ºèª
curl -X GET http://localhost:8000/api/v1/cache/status
# Expected: {"redis": "connected", "keys": 0}
```

==== æ©Ÿèƒ½åˆ¥ãƒ†ã‚¹ãƒˆ
```bash
# YOLOæ¨è«–ãƒ†ã‚¹ãƒˆ
python -m src.scripts.test_yolo

# MediaPipe ãƒ†ã‚¹ãƒˆ
python -m src.scripts.test_mediapipe

# WebSocketæ¥ç¶šãƒ†ã‚¹ãƒˆ
python -m src.scripts.test_websocket

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
python -m src.scripts.benchmark
```

=== ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼

==== ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç›£è¦–
```bash
# CPUãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ç›£è¦–
htop

# GPUä½¿ç”¨ç‡ç›£è¦–ï¼ˆNVIDIAï¼‰
watch -n 1 nvidia-smi

# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–
nethogs

# ãƒ‡ã‚£ã‚¹ã‚¯I/Oç›£è¦–
iotop
```

==== ãƒ­ã‚°ç¢ºèª
```bash
# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°
tail -f /opt/kanshichan/backend/logs/kanshichan.log

# ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°
sudo journalctl -u kanshichan -f

# Nginx ãƒ­ã‚°
sudo tail -f /var/log/nginx/access.log
sudo tail -f /var/log/nginx/error.log
```

=== ğŸš¨ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

==== ã‚ˆãã‚ã‚‹å•é¡Œã¨å¯¾å‡¦æ³•
[cols="2,3,2", options="header"]
|===
|å•é¡Œ |åŸå› ãƒ»å¯¾å‡¦æ³• |ç¢ºèªã‚³ãƒãƒ³ãƒ‰
|**èµ·å‹•å¤±æ•—** |è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ä¾å­˜é–¢ä¿‚å•é¡Œ |`journalctl -u kanshichan`
|**YOLO ã‚¨ãƒ©ãƒ¼** |ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»GPUè¨­å®šå•é¡Œ |`python -m src.scripts.test_yolo`
|**Redis æ¥ç¶šå¤±æ•—** |Redisæœªèµ·å‹•ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®š |`redis-cli ping`
|**ãƒ¡ãƒ¢ãƒªä¸è¶³** |ãƒãƒƒãƒã‚µã‚¤ã‚ºãƒ»ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚µã‚¤ã‚ºéå¤§ |`free -h`, `top`
|**é«˜CPUä½¿ç”¨ç‡** |ãƒ•ãƒ¬ãƒ¼ãƒ ã‚¹ã‚­ãƒƒãƒ—ç„¡åŠ¹ãƒ»éè² è· |`htop`, è¨­å®šèª¿æ•´
|===

==== ç·Šæ€¥æ™‚å¯¾å¿œ
```bash
# ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
sudo systemctl restart kanshichan
sudo systemctl restart redis-server
sudo systemctl restart nginx

# ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«å¤‰æ›´ï¼ˆãƒ‡ãƒãƒƒã‚°ï¼‰
# config.yaml ã® logging.level ã‚’ "DEBUG" ã«å¤‰æ›´
sudo systemctl reload kanshichan

# ç·Šæ€¥åœæ­¢
sudo systemctl stop kanshichan

# è¨­å®šãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
git checkout HEAD~1 backend/config/config.yaml
sudo systemctl restart kanshichan
```

== ğŸ“‹ é‹ç”¨ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

=== âœ… ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ãƒã‚§ãƒƒã‚¯

==== åŸºæœ¬ç’°å¢ƒ
* [ ] Python 3.11 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ä»®æƒ³ç’°å¢ƒä½œæˆ
* [ ] å¿…é ˆãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆrequirements.txtï¼‰
* [ ] Redis ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒ»æ¥ç¶šç¢ºèª
* [ ] Git ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³ãƒ»ãƒ–ãƒ©ãƒ³ãƒç¢ºèª

==== ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
* [ ] è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆãƒ»ç·¨é›†ï¼ˆconfig.yaml, .envï¼‰
* [ ] AI/MLãƒ¢ãƒ‡ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»é…ç½®
* [ ] ã‚µãƒ¼ãƒ“ã‚¹èµ·å‹•ãƒ»ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æˆåŠŸ
* [ ] WebSocketæ¥ç¶šãƒ»APIå‹•ä½œç¢ºèª

==== ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
* [ ] ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š
* [ ] SSLè¨¼æ˜æ›¸è¨­ç½®ãƒ»æœ‰åŠ¹åŒ–
* [ ] ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ»ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼è¨­å®š
* [ ] ä¸è¦ãƒãƒ¼ãƒˆãƒ»ã‚µãƒ¼ãƒ“ã‚¹ç„¡åŠ¹åŒ–

==== ç›£è¦–ãƒ»ãƒ­ã‚°
* [ ] ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ç¢ºèª
* [ ] ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
* [ ] ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†è¨­å®š
* [ ] ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

=== ğŸ“… å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

==== æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯
* [ ] ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒçŠ¶æ³ç¢ºèª
* [ ] ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
* [ ] ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨ç‡ç¢ºèª
* [ ] ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Ÿè¡ŒçŠ¶æ³ç¢ºèª

==== é€±æ¬¡ãƒã‚§ãƒƒã‚¯
* [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹åˆ†æ
* [ ] ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«æ•´ç†
* [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒç¢ºèª
* [ ] ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç¢ºèª

==== æœˆæ¬¡ãƒã‚§ãƒƒã‚¯
* [ ] ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
* [ ] è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«è¦‹ç›´ã—
* [ ] ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ›´æ–°æ¤œè¨
* [ ] å®¹é‡ãƒ»æ€§èƒ½è¨ˆç”»è¦‹ç›´ã—

== ğŸ”— é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

=== ğŸ“– å¿…é ˆå‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
* **<<configuration-guide>>**: è©³ç´°è¨­å®šã‚¬ã‚¤ãƒ‰ï¼ˆè¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è©³ç´°ï¼‰
* **<<backend-architecture>>**: ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆå…¨ä½“æ§‹æˆç†è§£ï¼‰
* **<<operations-monitoring>>**: é‹ç”¨ãƒ»ç›£è¦–ï¼ˆé‹ç”¨æ‰‹é †è©³ç´°ï¼‰
* **<<troubleshooting-guide>>**: ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆå•é¡Œè§£æ±ºæ‰‹æ³•ï¼‰

=== ğŸ› ï¸ é–‹ç™ºè€…å‘ã‘ãƒªã‚½ãƒ¼ã‚¹
* **<<development-guide>>**: é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆé–‹ç™ºè€…å‘ã‘è©³ç´°ï¼‰
* **<<rest-api-reference>>**: REST APIä»•æ§˜ï¼ˆAPIåˆ©ç”¨æ–¹æ³•ï¼‰
* **<<websocket-api>>**: WebSocket APIä»•æ§˜ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ï¼‰
* **<<testing-strategy>>**: ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ï¼ˆå“è³ªä¿è¨¼æ‰‹æ³•ï¼‰

=== ğŸ“Š æŠ€è¡“è©³ç´°
* **<<ai-ml-specifications>>**: AI/MLæŠ€è¡“ä»•æ§˜ï¼ˆAIæ©Ÿèƒ½è©³ç´°ï¼‰
* **<<performance-optimization>>**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼ˆæ€§èƒ½æ”¹å–„ï¼‰
* **<<security-specifications>>**: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä»•æ§˜ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è©³ç´°ï¼‰

[NOTE]
====
ğŸ”„ **ç¶™ç¶šçš„æ”¹å–„**

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å®Ÿéš›ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—çµŒé¨“ã¨é‹ç”¨å®Ÿç¸¾ã«åŸºã¥ã„ã¦
ç¶™ç¶šçš„ã«æ›´æ–°ãƒ»æ”¹å–„ã•ã‚Œã¾ã™ã€‚

**ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: team@kanshichan.dev +
**æ”¹å–„ææ¡ˆ**: GitHub Issues ã§ã®å ±å‘Šæ¨å¥¨
====

---

**ğŸ“ Contact**: team@kanshichan.dev +
**ğŸ”— Repository**: https://github.com/kanshichan/backend +
**ğŸ“… Last Updated**: {docdate} +
**ğŸ“ Document Version**: {revnumber} 