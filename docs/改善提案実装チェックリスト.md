# 改善提案・今日の洞察改善領域

実装進捗管理チェックリスト

---

## Phase 0: 事前準備
- [x] 規約ファイル（README, main_rules.yaml, coding_rules.yaml, comment_rules.yaml）を再確認
- [ ] 開発ブランチ `feature/improvement-refactor` を作成
- [ ] 関連 Issue / タスクをリンク

## Phase 1: 分析 & 設計
### 1.1 要件・仕様確定
- [x] 「改善領域」と「改善提案」の役割を文書化（重複排除）
- [x] 音声アドバイス統合に必要な追加フィールド（`audio_url`, `voice_text`, `tts_requested`）を定義
- [x] Recommendation 共通スキーマ（Dataclass / Interface）設計

### 1.2 データモデル設計
- [x] DB 変更有無の確認（追加カラムが必要か）
- [x] マイグレーション方針決定 (Alembic など)

### 1.3 API 仕様策定
- [x] `/api/analysis/basic/recommendations` 応答フォーマット決定
- [x] Pagination & limit パラメータ仕様決定

## Phase 2: バックエンド実装
### 2.1 モデル/スキーマ
- [x] `RecommendationSchema` Dataclass 追加
- [x] 既存 `BehaviorAnalyzer._generate_recommendations` の戻り値をスキーマ準拠に変更
- [x] マイグレーションスクリプト作成・適用（必要であれば）

### 2.2 API エンドポイント改修
- [x] `/recommendations` ルートを新スキーマ対応
- [x] `limit`, `page` パラメータ対応 & デフォルト見直し
- [x] 優先度 + timestamp の複合ソート実装
- [x] `audio_url` 等フィールドを含める

### 2.3 ユニットテスト
- [x] 新スキーマ生成テスト
- [x] `/recommendations` 応答フォーマットテスト
- [x] ページネーション & フィルタリングテスト

## Phase 3: フロントエンド実装
### 3.1 型定義 & データ取得
- [x] `Recommendation` interface を新スキーマに合わせて更新
- [x] API 呼び出しを `page`, `limit` パラメータ対応

### 3.2 UI 改修
- [x] `Select` → `Tabs` に置き換え（重要／普通／軽微）
- [x] 「コピー」アイコン追加（クリップボード）
- [x] 「音声再生」ボタン（`audio_url` ありの場合のみ活性）
- [x] 長文省略表示 (`Collapse`) 実装

### 3.3 ページネーション UI
- [x] 「もっと見る」ボタン or infinite scroll 実装
- [x] 読み込み中 Skeleton 表示

### 3.4 テスト
- [x] コンポーネント単体テスト (React Testing Library)
- [x] e2e テスト (Cypress) 更新

## Phase 4: 品質保証
### 4.1 動作検証
- [x] API エンドポイント検証（Postman 等）
- [x] 推奨事項表示機能検証
- [x] 優先度フィルタリング確認
- [x] ページネーション動作確認

### 4.2 コード品質チェック
- [x] バックエンド Flake8/MyPy 検証
- [x] フロントエンド ESLint 検証
- [x] 共通型定義の整合性確認
- [x] セキュリティ検証（XSS 等）

### 4.3 ドキュメント更新
- [x] API 仕様書更新
- [x] 開発ドキュメント更新

## Phase 5: 最終確認 & ドキュメント
### 5.1 最終検証
- [x] バージョン互換性確認（既存機能への影響）
- [x] 本番環境同等テスト
- [x] 規約準拠最終確認

### 5.2 リリースドキュメント
- [x] API仕様書最終版作成・共有
- [x] 変更履歴作成
- [x] バグ報告手順の明確化

### 5.3 改善提案
- [x] 次フェーズの機能拡張案整理
- [x] 音声アドバイス統合プラン策定

### 5.4 ナレッジベース更新
- [x] 開発ドキュメント更新・チェックイン
- [x] 主要な決定事項と設計選択の記録

## 実装完了: 2023-06-12

---

*更新日時: 2025-06-12* 